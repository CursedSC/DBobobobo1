-- Lord of the Mysteries Pathway System
-- Система последовательностей из LOTM для кастомных персонажей

LOTM = LOTM or {}
LOTM.Pathways = {}
LOTM.Sequences = {}

-- Определение всех 22 путей
LOTM.PathwaysList = {
    [1] = {id = 1, name = "Дурак", nameEn = "Fool", color = Color(128, 128, 128)},
    [2] = {id = 2, name = "Дверь", nameEn = "Door", color = Color(139, 69, 19)},
    [3] = {id = 3, name = "Ошибка", nameEn = "Error", color = Color(255, 0, 0)},
    [4] = {id = 4, name = "Провидец", nameEn = "Seer", color = Color(138, 43, 226)},
    [5] = {id = 5, name = "Ученик", nameEn = "Apprentice", color = Color(70, 130, 180)},
    [6] = {id = 6, name = "Вор", nameEn = "Marauder", color = Color(47, 79, 79)},
    [7] = {id = 7, name = "Зритель", nameEn = "Spectator", color = Color(0, 191, 255)},
    [8] = {id = 8, name = "Матрос", nameEn = "Sailor", color = Color(30, 144, 255)},
    [9] = {id = 9, name = "Читатель", nameEn = "Reader", color = Color(255, 215, 0)},
    [10] = {id = 10, name = "Тайна", nameEn = "Mystery Pryer", color = Color(75, 0, 130)},
    [11] = {id = 11, name = "Колесо Фортуны", nameEn = "Wheel of Fortune", color = Color(218, 165, 32)},
    [12] = {id = 12, name = "Монстр", nameEn = "Monster", color = Color(0, 100, 0)},
    [13] = {id = 13, name = "Воин", nameEn = "Warrior", color = Color(178, 34, 34)},
    [14] = {id = 14, name = "Охотник", nameEn = "Hunter", color = Color(205, 92, 92)},
    [15] = {id = 15, name = "Смерть", nameEn = "Death", color = Color(25, 25, 25)},
    [16] = {id = 16, name = "Тьма", nameEn = "Darkness", color = Color(0, 0, 0)},
    [17] = {id = 17, name = "Солнце", nameEn = "Sun", color = Color(255, 215, 0)},
    [18] = {id = 18, name = "Буря", nameEn = "Tyrant", color = Color(0, 0, 139)},
    [19] = {id = 19, name = "Ремесленник", nameEn = "Paragon", color = Color(184, 134, 11)},
    [20] = {id = 20, name = "Юрист", nameEn = "Arbiter", color = Color(128, 0, 0)},
    [21] = {id = 21, name = "Провидица", nameEn = "Demoness", color = Color(199, 21, 133)},
    [22] = {id = 22, name = "Узник", nameEn = "Prisoner", color = Color(105, 105, 105)},
}

-- Последовательности для каждого пути (Sequence 9 -> Sequence 0)
LOTM.SequenceNames = {}

-- Путь Дурака (The Fool)
LOTM.SequenceNames[1] = {
    [9] = "Провидец",
    [8] = "Клоун",
    [7] = "Фокусник",
    [6] = "Безликий",
    [5] = "Марионетист",
    [4] = "Бизарный Провидец",
    [3] = "Ученый Свитков",
    [2] = "Мастер Чудес",
    [1] = "Слуга Тайн",
    [0] = "Дурак",
}

-- Путь Двери (The Door)
LOTM.SequenceNames[2] = {
    [9] = "Защитник",
    [8] = "Эксорцист",
    [7] = "Священник Света",
    [6] = "Хранитель Солнца",
    [5] = "Летний",
    [4] = "Жрец Света",
    [3] = "Святой",
    [2] = "Ангел Воображения",
    [1] = "Визионер",
    [0] = "Белая Башня",
}

-- Путь Ошибки (The Error)
LOTM.SequenceNames[3] = {
    [9] = "Ошибка",
    [8] = "Паразит",
    [7] = "Обман",
    [6] = "Ветер",
    [5] = "Путешественник Снов",
    [4] = "Манипулятор",
    [3] = "Шепчущий",
    [2] = "Слуга Тайн",
    [1] = "Бог",
    [0] = "Тварь Хаоса",
}

-- Путь Провидца (The Mystery Pryer)
LOTM.SequenceNames[4] = {
    [9] = "Провидец",
    [8] = "Клоун",
    [7] = "Фокусник",
    [6] = "Безликий",
    [5] = "Марионетист",
    [4] = "Бизарный Провидец",
    [3] = "Ученый Свитков",
    [2] = "Мастер Чудес",
    [1] = "Слуга Тайн",
    [0] = "Дурак",
}

-- Путь Ученика (The Apprentice)
LOTM.SequenceNames[5] = {
    [9] = "Ученик",
    [8] = "Археолог",
    [7] = "Аналитик",
    [6] = "Путешественник по Записям",
    [5] = "Дрессировщик Хаоса",
    [4] = "Мистический Реформист",
    [3] = "Странник",
    [2] = "Планарист",
    [1] = "Мудрец",
    [0] = "Маг",
}

-- Путь Вора (The Marauder)
LOTM.SequenceNames[6] = {
    [9] = "Вор",
    [8] = "Мошенник",
    [7] = "Криптограф",
    [6] = "Перехватчик Удачи",
    [5] = "Червь Времени",
    [4] = "Паразитический Вор",
    [3] = "Обманщик Судьбы",
    [2] = "Чудотворец",
    [1] = "Похититель Судеб",
    [0] = "Ошибка",
}

-- Путь Зрителя (The Spectator)
LOTM.SequenceNames[7] = {
    [9] = "Зритель",
    [8] = "Телепат",
    [7] = "Психолог",
    [6] = "Гипнотизёр",
    [5] = "Манипулятор Снами",
    [4] = "Психолог-Алхимик",
    [3] = "Визионер",
    [2] = "Автор",
    [1] = "Дракон Воображения",
    [0] = "Визионер",
}

-- Путь Матроса (The Sailor)
LOTM.SequenceNames[8] = {
    [9] = "Матрос",
    [8] = "Мастер по Ветру",
    [7] = "Певец Рассвета",
    [6] = "Пожиратель Ветра",
    [5] = "Повелитель Океанских Волн",
    [4] = "Владыка Штормов",
    [3] = "Властитель Катастроф",
    [2] = "Морской Король",
    [1] = "Тиран",
    [0] = "Тиран",
}

-- Путь Читателя (The Reader)
LOTM.SequenceNames[9] = {
    [9] = "Читатель",
    [8] = "Историк",
    [7] = "Мистицист",
    [6] = "Профессор",
    [5] = "Мудрец",
    [4] = "Философ",
    [3] = "Ученый",
    [2] = "Хранитель Мудрости",
    [1] = "Эрудит",
    [0] = "Око Всезнания",
}

-- Путь Тайны (The Mystery)
LOTM.SequenceNames[10] = {
    [9] = "Секретный Молитвенник",
    [8] = "Слушатель",
    [7] = "Психик",
    [6] = "Фанатик",
    [5] = "Пастух",
    [4] = "Мистический Учитель",
    [3] = "Святой Дух",
    [2] = "Служитель Тайн",
    [1] = "Мудрый Ангел",
    [0] = "Бог Знаний",
}

-- Путь Колеса Фортуны (Wheel of Fortune)
LOTM.SequenceNames[11] = {
    [9] = "Монстр",
    [8] = "Удачливец",
    [7] = "Победитель",
    [6] = "Искатель Удачи",
    [5] = "Маэстро Неудачи",
    [4] = "Дрессировщик Опасности",
    [3] = "Игрок",
    [2] = "Покоритель Хаоса",
    [1] = "Ангел Милосердия",
    [0] = "Колесо Фортуны",
}

-- Путь Монстра (The Monster)
LOTM.SequenceNames[12] = {
    [9] = "Монстр",
    [8] = "Оборотень",
    [7] = "Зверь Рождественской Ночи",
    [6] = "Вампир",
    [5] = "Барон Крови",
    [4] = "Герцог Крови",
    [3] = "Дух Стихии",
    [2] = "Предок Вампиров",
    [1] = "Красный Жрец",
    [0] = "Луна",
}

-- Путь Воина (The Warrior)
LOTM.SequenceNames[13] = {
    [9] = "Воин",
    [8] = "Гладиатор",
    [7] = "Бершеркер",
    [6] = "Рассвет Паладин",
    [5] = "Хранитель",
    [4] = "Заступник",
    [3] = "Повелитель Войны",
    [2] = "Принц Избиения",
    [1] = "Победоносный",
    [0] = "Красный Жрец",
}

-- Путь Охотника (The Hunter)
LOTM.SequenceNames[14] = {
    [9] = "Охотник",
    [8] = "Провокатор",
    [7] = "Поджигатель",
    [6] = "Заговорщик",
    [5] = "Пироман",
    [4] = "Железнокровный Рыцарь",
    [3] = "Хранитель Погибели",
    [2] = "Завоеватель",
    [1] = "Принц Катастроф",
    [0] = "Красный Жрец",
}

-- Путь Смерти (The Death)
LOTM.SequenceNames[15] = {
    [9] = "Трупособиратель",
    [8] = "Заключённый",
    [7] = "Оборотень",
    [6] = "Призрак",
    [5] = "Кукловод",
    [4] = "Бизарный Охотник",
    [3] = "Дух Проклятий",
    [2] = "Смерть Консула",
    [1] = "Ферро",
    [0] = "Смерть",
}

-- Путь Тьмы (The Darkness)
LOTM.SequenceNames[16] = {
    [9] = "Спящий",
    [8] = "Полуночный Поэт",
    [7] = "Кошмар",
    [6] = "Путешественник Снов",
    [5] = "Хранитель",
    [4] = "Пожиратель Снов",
    [3] = "Страж",
    [2] = "Принц Тайны",
    [1] = "Князь Безумия",
    [0] = "Тьма",
}

-- Путь Солнца (The Sun)
LOTM.SequenceNames[17] = {
    [9] = "Певец",
    [8] = "Молитвослов",
    [7] = "Священник Солнца",
    [6] = "Отвергающий Свет",
    [5] = "Капеллан",
    [4] = "Жрец Света",
    [3] = "Бог Солнца",
    [2] = "Ангел Солнца",
    [1] = "Визионер Солнца",
    [0] = "Вечное Сияющее Солнце",
}

-- Путь Бури (The Tyrant)
LOTM.SequenceNames[18] = {
    [9] = "Матрос",
    [8] = "Мастер по Ветру",
    [7] = "Певец Рассвета",
    [6] = "Пожиратель Ветра",
    [5] = "Повелитель Океанских Волн",
    [4] = "Владыка Штормов",
    [3] = "Властитель Катастроф",
    [2] = "Морской Король",
    [1] = "Тиран",
    [0] = "Тиран",
}

-- Путь Ремесленника (The Paragon)
LOTM.SequenceNames[19] = {
    [9] = "Ремесленник",
    [8] = "Археолог",
    [7] = "Аналитик",
    [6] = "Аппраизер",
    [5] = "Астроном",
    [4] = "Философский Камень",
    [3] = "Мастер Ремесленник",
    [2] = "Ангел Воображения",
    [1] = "Мудрец",
    [0] = "Маг",
}

-- Путь Юриста (The Arbiter)
LOTM.SequenceNames[20] = {
    [9] = "Юрист",
    [8] = "Варвар",
    [7] = "Бершеркер",
    [6] = "Инспектор",
    [5] = "Дисциплинированный Паладин",
    [4] = "Хранитель",
    [3] = "Принц Порядка",
    [2] = "Принц Империи",
    [1] = "Император Порядка",
    [0] = "Правосудие",
}

-- Путь Провидицы (The Demoness)
LOTM.SequenceNames[21] = {
    [9] = "Убийца",
    [8] = "Инсигатор",
    [7] = "Ведьма",
    [6] = "Удовольствие",
    [5] = "Несчастье",
    [4] = "Демонесса Отчаяния",
    [3] = "Демонесса Апокалипсиса",
    [2] = "Первобытная Демонесса",
    [1] = "Белая Демонесса",
    [0] = "Первозданная",
}

-- Путь Узника (The Prisoner)
LOTM.SequenceNames[22] = {
    [9] = "Узник",
    [8] = "Сумасшедший",
    [7] = "Оборотень",
    [6] = "Живущий",
    [5] = "Чума",
    [4] = "Безмолвный Ученик",
    [3] = "Роза Искупления",
    [2] = "Пожиратель",
    [1] = "Мать",
    [0] = "Луна",
}

function LOTM.GetPathwayName(pathwayId)
    if not LOTM.PathwaysList[pathwayId] then return "Неизвестный путь" end
    return LOTM.PathwaysList[pathwayId].name
end

function LOTM.GetSequenceName(pathwayId, sequence)
    if not LOTM.SequenceNames[pathwayId] then return "Неизвестная последовательность" end
    if not LOTM.SequenceNames[pathwayId][sequence] then return "Неизвестная последовательность" end
    return LOTM.SequenceNames[pathwayId][sequence]
end

function LOTM.GetPathwayColor(pathwayId)
    if not LOTM.PathwaysList[pathwayId] then return Color(255, 255, 255) end
    return LOTM.PathwaysList[pathwayId].color
end

function LOTM.GetFullSequenceName(pathwayId, sequence)
    local pathway = LOTM.GetPathwayName(pathwayId)
    local seqName = LOTM.GetSequenceName(pathwayId, sequence)
    return string.format("Последовательность %d: %s (Путь %s)", sequence, seqName, pathway)
end

-- Получить все доступные пути для выбора
function LOTM.GetAvailablePathways()
    return LOTM.PathwaysList
end

-- Проверить, можно ли повысить последовательность
function LOTM.CanPromoteSequence(currentSequence)
    return currentSequence > 0
end

-- Повысить последовательность (понизить число)
function LOTM.PromoteSequence(currentSequence)
    if LOTM.CanPromoteSequence(currentSequence) then
        return currentSequence - 1
    end
    return currentSequence
end

if SERVER then
    print("[LOTM] Система последовательностей загружена: " .. #LOTM.PathwaysList .. " путей")
end

if CLIENT then
    print("[LOTM] Клиентская часть системы последовательностей загружена")
end